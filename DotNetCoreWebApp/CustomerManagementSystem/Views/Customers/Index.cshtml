@using CustomerManagementSystem.Models.CustomerViewModel;
@model IEnumerable<CustomerVM>

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link href="~/lib/sweetalert2/sweetalert2.min.css" rel="stylesheet" />
<link href="~/lib/datatables.net-bs5/dataTables.bootstrap5.min.css" rel="stylesheet" />
<link href="~/lib/datatables.net-responsive-bs5/responsive.bootstrap5.min.css" rel="stylesheet" />

<form id="mainForm" method="post">
    <input name="SelectedId" id="SelectedId" type="hidden" />

    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

            <div class="card mb-3">
                <div class="card-header">
                    <h5 class="float-start mt-1">Customers List</h5>
                    <a class="btn btn-success float-end" asp-action="Create"><i class="fas fa-plus-circle"></i> New Customer</a>
                </div>
                <div class="card-body">
                    
                    <!-- Loader -->
                    <div class="overlay loader text-center" hidden="hidden">
                        <i class="fas fa-2x fa-sync-alt fa-spin"></i>
                    </div>

                    <!-- partial view -->
                    <div id="partial" hidden="hidden">
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>

@section Scripts {

    <script src="~/lib/sweetalert2/sweetalert2.min.js"></script>

    <script src="~/lib/datatables.net/jquery.dataTables.min.js"></script>
    <script src="~/lib/datatables.net-bs5/dataTables.bootstrap5.min.js"></script>
    <script src="~/lib/datatables-responsive/dataTables.responsive.min.js"></script>
    <script src="~/lib/datatables.net-responsive-bs5/responsive.bootstrap5.min.js"></script>

    <script>

        $(function () {

            $('#partial').attr("hidden", "hidden");
            $(".loader").removeAttr("hidden", "hidden");

            loadPartialView();

        });        

        function loadPartialView() {

            $.ajax({
                type: "POST",
                url: "/Customers/LoadPartialList",
                success: function (response) {
                    var loaderTimer = setInterval(function () {
                        $(".loader").attr("hidden", "hidden");
                        clearInterval(loaderTimer);
                        $("#partial").html(response);
                        $('#partial').removeAttr("hidden", "hidden");
                    }, 2000);

                },
                failure: function (response) {
                    alert(response.responseText);
                },
                error: function (response) {
                    alert(response.responseText);
                }
            });
        }

    </script>

}