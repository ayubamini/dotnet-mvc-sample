@using CustomerManagementSystem.Models.CustomerViewModel;
@model IEnumerable<CustomerVM>

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link href="~/lib/datatables.net-bs5/dataTables.bootstrap5.min.css" rel="stylesheet" />
<link href="~/lib/sweetalert2/sweetalert2.min.css" rel="stylesheet" />

<h1>Customers</h1>
<br />

<form id="mainForm" method="post">
    <input name="SelectedId" id="SelectedId" type="hidden" />

    <p>
        <a class="btn btn-success" asp-action="Create"><i class="fas fa-plus-circle"></i> Create</a>
    </p>

    @await Html.PartialAsync("_List", Model)

</form>

@section Scripts {

    <script src="~/lib/datatables.net/jquery.dataTables.min.js"></script>
    <script src="~/lib/datatables.net-bs5/dataT ables.bootstrap5.min.js"></script>
    <script src="~/lib/sweetalert2/sweetalert2.min.js"></script>
    <script>

        $(function(){

            $('#datatable').DataTable({
                "responsive": true,
                "paging": true,
                "searching": true,
                "columnDefs": [{
                    targets: 3,
                    orderable: false,
                }],
            });

            $('.btnDelete').click(function (e) {
                Swal.fire({
                    title: 'Are you sure?',
                    text: "You won't be able to revert this!",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Yes, delete it!'
                }).then((result) => {
                    if (result.isConfirmed) {
                        var btn = $(this);
                        var id = btn.data("id");
                        $("#SelectedId").val(id);
                        document.getElementById('mainForm').action = '/Customers/DeleteConfirmed';
                        document.getElementById('mainForm').submit();
                    }
                });
            });
        });


        

    </script>

}